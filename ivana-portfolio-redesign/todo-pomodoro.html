<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" />
<title>To-Do + Pomodoro</title>
<link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="assets/styles.css">
<style>
.wrap{max-width:980px;margin:0 auto;padding:24px}
.grid{display:grid;grid-template-columns:1.1fr .9fr;gap:18px}
.card{background:#fff;border-radius:22px;box-shadow:var(--shadow);padding:18px;border:1px solid rgba(0,0,0,.06)}
.list{display:grid;gap:10px;margin-top:10px}
.item{display:flex;align-items:center;gap:10px;border:1px solid #e8ded7;padding:10px;border-radius:12px}
.item.done{opacity:.6;text-decoration:line-through}
.btn{appearance:none;border:none;border-radius:12px;padding:10px 14px;background:var(--green);color:#fff;font-weight:800;cursor:pointer}
.btn.ghost{background:#fff;color:var(--green);border:2px solid var(--green)}
.clock{display:grid;place-items:center;gap:10px}
.ring{width:200px;height:200px;border-radius:999px;background:
  radial-gradient(circle at 50% 50%, #fff 62%, transparent 62%),
  conic-gradient(var(--green) var(--pct,0%), rgba(0,0,0,.12) 0);box-shadow:var(--shadow);position:relative}
.ring::after{content:attr(data-time);position:absolute;inset:0;display:grid;place-items:center;font-family:var(--font-serif);font-size:32px;color:var(--terracotta)}
@media(max-width:960px){.grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="wrap">
  <h2 class="title">To‑Do + Pomodoro</h2>
  <div class="grid">
    <div class="card">
      <div style="display:flex;gap:8px">
        <input id="tdInput" placeholder="New task…" style="flex:1;padding:10px;border-radius:10px;border:1px solid #d9cec7">
        <button class="btn" id="tdAdd">Add</button>
      </div>
      <div class="list" id="tdList"></div>
      <div style="display:flex;gap:8px;margin-top:10px">
        <button class="btn ghost" id="clearDone">Clear completed</button>
        <button class="btn ghost" id="clearAll">Clear all</button>
      </div>
    </div>

    <div class="card clock">
      <div class="ring" id="ring" data-time="25:00"></div>
      <div style="display:flex;gap:8px;flex-wrap:wrap;justify-content:center">
        <button class="btn" id="start">Start</button>
        <button class="btn" id="pause">Pause</button>
        <button class="btn" id="reset">Reset</button>
      </div>
      <div class="badge" id="modeBadge" style="text-align:center;font-weight:800;color:#6f6661">Focus 25</div>
      <div id="activeTask" style="color:#6f6661"></div>
    </div>
  </div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function(){
  const $=s=>document.querySelector(s), key='todo-pomo-v3';
  let state; try{ state=JSON.parse(localStorage.getItem(key))||{tasks:[]}; }catch{ state={tasks:[]}; }
  const list=$('#tdList'), input=$('#tdInput');
  function save(){ localStorage.setItem(key, JSON.stringify(state)); }
  function render(){ list.innerHTML=''; state.tasks.forEach(t=>{ const row=document.createElement('div'); row.className='item'+(t.done?' done':''); row.innerHTML=`
    <input type="checkbox" ${t.done?'checked':''} data-toggle="${t.id}">
    <div style="flex:1">${t.title}</div>
    <button class="btn ghost" data-focus="${t.id}">▶ Focus</button>
    <button class="btn" style="background:var(--terracotta)" data-del="${t.id}">Delete</button>`; list.appendChild(row); }); }
  function add(){ const v=input.value.trim(); if(!v) return; state.tasks.unshift({id:Date.now(),title:v,done:false}); input.value=''; save(); render(); }
  function toggle(id){ const t=state.tasks.find(x=>x.id===id); if(t){ t.done=!t.done; save(); render(); } }
  function remove(id){ state.tasks=state.tasks.filter(x=>x.id!==id); save(); render(); }
  $('#tdAdd').onclick=add; input.addEventListener('keydown',e=>{ if(e.key==='Enter') add(); });
  list.addEventListener('click',e=>{ const t=e.target; const tog=t.getAttribute('data-toggle'), del=t.getAttribute('data-del'), foc=t.getAttribute('data-focus');
    if(tog) toggle(+tog); if(del) remove(+del); if(foc) linkTask(+foc); });
  $('#clearDone').onclick=()=>{ state.tasks=state.tasks.filter(x=>!x.done); save(); render(); };
  $('#clearAll').onclick=()=>{ if(confirm('Delete all tasks?')){ state.tasks=[]; save(); render(); } };
  render();

  // Pomodoro
  const ring=$('#ring'), startBtn=$('#start'), pauseBtn=$('#pause'), resetBtn=$('#reset'),
        modeBadge=$('#modeBadge'), activeTask=$('#activeTask');
  let mode='focus', focusLen=25*60, breakLen=5*60, remaining=focusLen, timer=null;
  function display(){ const m=String(Math.floor(remaining/60)).padStart(2,'0'); const s=String(remaining%60).padStart(2,'0');
    ring.dataset.time=`${m}:${s}`; const total=(mode==='focus'?focusLen:breakLen); ring.style.setProperty('--pct',(1-remaining/total)*100+'%');
    modeBadge.textContent=(mode==='focus'?`Focus ${focusLen/60}`:`Break ${breakLen/60}`); }
  function tick(){ if(remaining>0){ remaining--; display(); } else { mode=(mode==='focus')?'break':'focus'; remaining=(mode==='focus'?focusLen:breakLen); display(); } }
  function start(){ if(timer) return; timer=setInterval(tick,1000); }
  function pause(){ clearInterval(timer); timer=null; }
  function reset(){ pause(); mode='focus'; remaining=focusLen; display(); }
  function linkTask(id){ const t=state.tasks.find(x=>x.id===id); activeTask.textContent=t?`Focusing on: ${t.title}`:''; reset(); start(); }
  startBtn.onclick=start; pauseBtn.onclick=pause; resetBtn.onclick=reset; display();
});
</script>
</body>
</html>
